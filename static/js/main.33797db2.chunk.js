(this["webpackJsonpcrosstalk-client"]=this["webpackJsonpcrosstalk-client"]||[]).push([[0],{163:function(e,n,t){},176:function(e,n,t){},181:function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=181},184:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(60),c=t.n(o),s=(t(163),t(112)),i=t(21),l=t.n(i),u=t(33),h=t(12),d=t(89),j=t(16),p=t(252),b=t(253),f="/method",g=t(249),O=t(2),m=Object(j.f)((function(e){var n=e.history;return Object(O.jsxs)("div",{className:"header",children:[Object(O.jsxs)(p.a,{expand:"lg",children:[Object(O.jsxs)(p.a.Brand,{onClick:function(){n.push("/")},children:[" ",Object(O.jsx)("div",{children:"CrossTalk (Beta)"})," "]}),Object(O.jsx)(p.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(O.jsx)(p.a.Collapse,{id:"basic-navbar-nav",children:Object(O.jsxs)(b.a,{className:"ml-auto",children:[Object(O.jsx)(b.a.Link,{onClick:function(){n.push("/FEEDBACK")},children:" Feedback "}),Object(O.jsx)(b.a.Link,{onClick:function(){n.push(f)},children:" How to use "})]})})]}),Object(O.jsx)(g.a,{})]})})),x=t(263),v=t(256),w=t(95),y=t.n(w),T=new y.a({en:{whyThisWorks:"why this works",howToRule1:"You speak your native language, they speak their native language.",howToRule2:"Never speak the other persons language.",howToRule3:"Use actions, drawings, props, and whatever else you need to explain what you are saying.",howToRule4:"Never harass anyone for any reason! This is not a dating site!",howToRule5:"This is a beta, please provide as much feedback as possible jasongoodisondevelopment@gmail.com"},es:{whyThisWorks:"Por que esto funciona.",howToRule1:"Hablas tu lengua materna, ellos hablan la suya.",howToRule2:"Nunca hables el idioma de otras personas",howToRule3:"Utilice acciones, dibujos, accesorios y cualquier otra cosa que necesite para explicar lo que est\xe1 diciendo.",howToRule4:"\xa1Nunca acoses a nadie por ning\xfan motivo! \xa1Este no es un sitio de citas!",howToRule5:"Esta es una versi\xf3n beta, proporcione la mayor cantidad de comentarios posible jasongoodisondevelopment@gmail.com"},fr:{whyThisWorks:"Pourquoi \xe7a marche.",howToRule1:"Hablas tu lengua materna, ellos hablan la suya.",howToRule2:"Ne jamais parler la langue des autres.",howToRule3:"Utilisez des actions, des dessins, des accessoires et tout ce dont vous avez besoin pour expliquer ce que vous dites.",howToRule4:"Ne harcelez jamais personne pour quelque raison que ce soit ! Ceci n'est pas un site de rencontre!",howToRule5:"Ceci est une version b\xeata, veuillez fournir autant de commentaires que possible jasongoodisondevelopment@gmail.com"},cmn:{whyThisWorks:"\u4e3a\u4ec0\u4e48\u8fd9\u6709\u6548",howToRule1:"\u4f60\u8bf4\u4f60\u7684\u6bcd\u8bed\uff0c\u4ed6\u4eec\u8bf4\u4ed6\u4eec\u7684\u6bcd\u8bed",howToRule2:"\u6c38\u8fdc\u4e0d\u8981\u8bf4\u5176\u4ed6\u4eba\u7684\u8bed\u8a00\u3002",howToRule3:"\u4f7f\u7528\u52a8\u4f5c\u3001\u56fe\u753b\u3001\u9053\u5177\u548c\u5176\u4ed6\u4efb\u4f55\u4f60\u9700\u8981\u7684\u4e1c\u897f\u6765\u89e3\u91ca\u4f60\u5728\u8bf4\u4ec0\u4e48\u3002",howToRule4:"\u6c38\u8fdc\u4e0d\u8981\u4ee5\u4efb\u4f55\u7406\u7531\u9a9a\u6270\u4efb\u4f55\u4eba\u3002\u8fd9\u4e0d\u662f\u7ea6\u4f1a\u7f51\u7ad9",howToRule5:"\u8fd9\u662f\u4e00\u4e2a\u6d4b\u8bd5\u7248\uff0c\u8bf7\u63d0\u4f9b\u5c3d\u53ef\u80fd\u591a\u7684\u53cd\u9988 jasongoodisondevelopment@gmail.com"}}),k=t(255),R=t(261),C=t(262),S=t(129),E=t.n(S),F=t(244),I=function(){var e=[Object(O.jsxs)("div",{children:[T.howToRule1," (",Object(O.jsxs)("a",{href:"/method",children:[" ",T.whyThisWorks," "]}),")"]}),T.howToRule2,T.howToRule3,T.howToRule4,T.howToRule5];return Object(O.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginRight:150,marginTop:100},children:Object(O.jsxs)(k.a,{style:{maxWidth:500},expanded:!0,children:[Object(O.jsx)(R.a,{expandIcon:Object(O.jsx)(E.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(O.jsx)("h2",{style:{textAlign:"center"},children:" Rules "})}),Object(O.jsx)(C.a,{children:Object(O.jsx)(x.a,{children:e.map((function(e,n){return Object(O.jsxs)(v.a,{children:[Object(O.jsxs)("div",{style:{display:"flex"},children:[" ",n+1,".","  "," ",e," "]}),Object(O.jsx)(F.a,{})]})}))})})]})})},N=function(){return Object(O.jsx)(I,{})},A=(t(176),t(62)),L=t(142),P=t(134),q=t.n(P),z=t(115),U=t(135),W=t(73),B=t(138),D=t.n(B),H=t(139),M=t.n(H),G=t(140),J=t.n(G),_=t(141),Y=t.n(_),K=t(250),V="localhost:3000";function Q(){return X.apply(this,arguments)}function X(){return(X=Object(u.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=localStorage.getItem("userId"))){e.next=6;break}return e.next=4,Z();case 4:n=e.sent,localStorage.setItem("userId",n);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return $.apply(this,arguments)}function $(){return($=Object(u.a)(l.a.mark((function e(){var n,t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(V,"/users/createNewEphemeralAccount"),{method:"POST",body:JSON.stringify({})});case 2:return n=e.sent,console.log("res",n),e.next=6,n.json();case 6:return t=e.sent,r=t._id,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee,ne,te="localhost:3000";function re(e,n){return ae.apply(this,arguments)}function ae(){return ae=Object(u.a)(l.a.mark((function e(n,t){var r,a,o,c,s=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.length>2&&void 0!==s[2]?s[2]:null,console.log("whats my id"),e.next=4,Q();case 4:return r=e.sent,console.log("got one, its ",r),e.next=8,fetch("".concat(te,"/rooms/getJoinableRoom/?native=").concat(n,"&learning=").concat(t,"&userId=").concat(r));case 8:return a=e.sent,e.next=11,a.json();case 11:return o=e.sent,c=o.roomId,e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}var oe=z.a.video(ee||(ee=Object(A.a)(["\n  width: 22%;\n  height: 22%;\n  position: absolute;\n  right: 0px;\n  bottom: 0px;\n"]))),ce=z.a.video(ne||(ne=Object(A.a)(["\nheight: 94vh;\nwidth: 94vw;\n"]))),se=function(e){e.hours;var n=e.minutes,t=e.seconds;return e.completed?Object(O.jsx)("div",{children:" We aren't finding anyone. Please keep this page open and we will keep looking "}):Object(O.jsxs)("span",{children:[n,":",t]})},ie=Object(j.f)((function(e){var n,t=e.match.params.roomId,a=e.userId,o=e.history,c=e.location.state,s=c.native,i=c.learning,d=Object(r.useRef)(),j=Object(r.useState)(0),p=Object(h.a)(j,2),b=p[0],f=p[1],g=Object(r.useRef)(),m=Object(r.useRef)(),x=Object(r.useState)(),v=Object(h.a)(x,2),w=v[0],y=v[1],T=Object(r.useRef)(),k=Object(r.useRef)(),R=Object(r.useState)(!0),C=Object(h.a)(R,2),S=C[0],E=C[1],F=Object(r.useState)(!0),I=Object(h.a)(F,2),N=I[0],A=I[1],P=Object(r.useState)(!0),z=Object(h.a)(P,2),B=z[0],H=z[1];function G(){return(G=Object(u.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Going to find another user to meet with"),e.next=3,re(s,i);case 3:n=e.sent,o.push({state:{learning:i,native:s},pathname:"/room/"+n}),m.current.disconnect(),g.current.srcObject=null,f(b+1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){var n=k.current;console.log("peer before clal",n),console.log("Calling ",e," with ",w);var t=n.call(e,T.current);console.log("CALL",t),t.on("stream",(function(e){console.log("stream coming in",e),g.current.srcObject=e,E(!1)})),t.on("close",(function(){g.current=null,E(!0)}))}console.log("NATIVE",s,i,e),Object(r.useEffect)((function(){console.log("RUNNING THE USEEFFECT HERER"),m.current=L.a.connect("localhost:3000",{transports:["websocket"]}),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){y(e),T.current=e,d.current&&(d.current.srcObject=e);var n=new q.a({initiator:!0,stream:e,host:"peerjs-server.herokuapp.com",port:443,secure:!0});k.current=n,n.on("open",(function(e){m.current.emit("set userId",a),m.current.on("ready userId",(function(){console.log("Associated! Going to join room"),m.current.emit("join-room",t,e)}))})),n.on("call",(function(e){console.log("Receiving a call. Answering it now"),E(!1),e.answer(T.current),e.on("stream",(function(e){console.log("Stream incoming"),g.current&&(g.current.srcObject=e)})),e.on("close",(function(){console.log("Stream from incoming call closed"),g.current=null,E(!0)}))})),m.current.on("user-connected",(function(e){console.log("user connected",e),setTimeout((function(){_(e)}),1e3)}))}),[b]),m.current.on("user-disconnected",(function(e){g.current&&(E(!0),g.current.srcObject=null)})),m.current.on("mic set",(function(e){A(e)}))}),[]),Object(r.useEffect)((function(){return function(){m.current.disconnect(),T.current.getTracks().forEach((function(e){e.stop(),e.enabled=!1})),T.current=null}}),[]),w&&(n=Object(O.jsx)(oe,{playsInline:!0,muted:!0,ref:d,autoPlay:!0}));var V=Object(O.jsx)(ce,{muted:!N,playsInline:!0,ref:g,autoPlay:!0});return Object(O.jsxs)("div",{style:{backgroundColor:"black"},children:[S&&Object(O.jsxs)("div",{style:{backgroundColor:"white"},children:[" Searching for partner ... ",Object(O.jsx)("br",{})," ",Object(O.jsx)(U.a,{renderer:se,date:Date.now()+299e3})," "]}),n,V,Object(O.jsxs)("div",{style:{position:"absolute",right:"46%",bottom:10,display:"flex",justifyContent:"space-between",width:"13%"},children:[Object(O.jsx)(K.a,{title:"Hang up",children:Object(O.jsxs)(W.a,{variant:"danger",onClick:function(){return o.push("/")},children:[" ",Object(O.jsx)(D.a,{fontSize:"large"})," "]})}),Object(O.jsx)(K.a,{title:"Turn Mic "+(B?"Off":"On"),children:Object(O.jsxs)(W.a,{variant:"primary",onClick:function(){m.current.emit("mic set",!B),H(!B)},children:[" ",B?Object(O.jsx)(J.a,{fontSize:"large"}):Object(O.jsx)(M.a,{fontSize:"large"})," "]})}),Object(O.jsx)(K.a,{title:"Find a new partner",children:Object(O.jsxs)(W.a,{variant:"secondary",onClick:function(){return G.apply(this,arguments)},children:[" ",Object(O.jsx)(Y.a,{fontSize:"large"})," "]})})]})]})})),le=t(251),ue=t(258),he=t(265),de=t(264),je=t(257),pe=t(259),be=new y.a({en:{English:"English",French:"French",Spanish:"Spanish",Chinese:"Chinese",FindAPartner:"Find a partner now!",Native:"Native",Learning:"Learning"},fr:{English:"Anglais",French:"Fran\xe7ais",Spanish:"Espagnol",Chinese:"Chinois",FindAPartner:"Trouvez un partenaire maintenant!",Native:"Originaire de",Learning:"Apprentissage"},es:{English:"Ingl\xe9s",French:"Franc\xe9s",Spanish:"Espa\xf1ol",Chinese:"Chino",FindAPartner:"\xa1Encuentra un socio ahora!",Native:"Nativo",Learning:"Aprendiendo"},cmn:{English:"\u82f1\u8bed",French:"\u6cd5\u8bed",Spanish:"\u897f\u73ed\u7259\u8bed",Chinese:"\u4e2d\u56fd\u4eba",FindAPartner:"\u7acb\u5373\u5bfb\u627e\u5408\u4f5c\u4f19\u4f34\uff01",Native:"\u672c\u56fd\u7684",Learning:"\u5b66\u4e60"}}),fe=Object(j.f)((function(e){var n=e.history,t=Object(r.useState)(""),a=Object(h.a)(t,2),o=a[0],c=a[1],s=Object(r.useState)(""),i=Object(h.a)(s,2),d=i[0],j=[c,i[1]],p=["English","Spanish","French","Chinese"];function b(){return(b=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d!==o){e.next=3;break}return alert("Please choose different languages"),e.abrupt("return");case 3:return e.next=5,f();case 5:t=e.sent,n.push({state:{learning:d,native:o},pathname:"/room/"+t});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(o,d);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(O.jsx)(pe.a,{justifyContent:"center",style:{width:"25%",marginRight:"auto",marginLeft:200,marginTop:100},children:Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{style:{marginBottom:30},children:"CrossTalk (Beta)"}),Object(O.jsxs)("div",{children:[j.map((function(e,n){return Object(O.jsx)(de.a,{sx:{minWidth:120,paddingBottom:1.5,textAlign:"left"},children:Object(O.jsxs)(he.a,{fullWidth:!0,children:[Object(O.jsx)(je.a,{id:"demo-simple-select-label",children:0===n?be.Native:be.Learning}),Object(O.jsx)(le.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:0==n?o:d,label:"Learning",onChange:function(n){return t=e,r=n.target.value,void t(r);var t,r},children:p.map((function(e){return Object(O.jsxs)(ue.a,{value:e,children:[" ",be[e]," "]})}))})]})})})),null!=d&&Object(O.jsxs)(W.a,{variant:"primary",onClick:function(){return b.apply(this,arguments)},children:[" ",be.FindAPartner," "]})]})]})})})),ge=function(){return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(O.jsx)(fe,{}),Object(O.jsx)(I,{})]})})};var Oe=function(){var e=Object(r.useState)(""),n=Object(h.a)(e,2),t=n[0],a=n[1];return Object(r.useEffect)(Object(u.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:n=e.sent,a(n);case 4:case"end":return e.stop()}}),e)}))),[]),console.log("GOT MY USER ID ITS",t),Object(O.jsx)("div",{className:"App",children:Object(O.jsxs)(d.a,{children:[Object(O.jsx)(m,{}),Object(O.jsxs)(j.c,{children:[Object(O.jsx)(j.a,{exact:!0,path:"/",component:ge}),Object(O.jsx)(j.a,{exact:!0,path:"/room/:roomId",component:function(e){return""===t?"Loading":Object(O.jsx)(ie,Object(s.a)(Object(s.a)({},e),{},{userId:t}))}}),Object(O.jsx)(j.a,{exact:!0,path:f,component:N})]})]})})},me=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,266)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,o=n.getLCP,c=n.getTTFB;t(e),r(e),a(e),o(e),c(e)}))};t(183);c.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(Oe,{})}),document.getElementById("root")),me()}},[[184,1,2]]]);
//# sourceMappingURL=main.33797db2.chunk.js.map